CREATE TABLE Anime (
id SERIAL NOT NULL PRIMARY KEY,
title VARCHAR(50) NOT NULL,
year TIMESTAMP NOT NULL,
author_id INT NOT NULL,
studio_id INT NOT NULL,
format VARCHAR(25) NOT NULL,
description VARCHAR(500) NOT NULL,
poster VARCHAR(200));



CREATE TABLE Author (
id SERIAL NOT NULL PRIMARY KEY,
first_name VARCHAR(50) NOT NULL,
middle_name VARCHAR(50),
last_name VARCHAR(50) NOT NULL,
photo VARCHAR(200),
biography VARCHAR(500) NOT NULL);



CREATE TABLE Studio (
id SERIAL NOT NULL PRIMARY KEY,
name VARCHAR(100) NOT NULL,
logo VARCHAR(200),
description VARCHAR(500) NOT NULL);



CREATE TABLE Review (
id SERIAL NOT NULL PRIMARY KEY,
text TEXT NOT NULL,
date TIMESTAMP NOT NULL,
rating SMALLINT NOT NULL,
user_id INT NOT NULL,
anime_id INT NOT NULL);



CREATE TABLE Person (
id SERIAL NOT NULL PRIMARY KEY,
nickname VARCHAR(50) NOT NULL,
login VARCHAR(50) NOT NULL,
password INT NOT NULL,
avatar VARCHAR(200),
about_yourself VARCHAR(500),
registration_date TIMESTAMP NOT NULL);



CREATE TABLE Genre (
id SERIAL NOT NULL PRIMARY KEY,
name VARCHAR(50) NOT NULL);



CREATE TABLE AnimeGenre (
id SERIAL NOT NULL PRIMARY KEY,
anime_id INT NOT NULL,
genre_id INT NOT NULL);



CREATE TABLE ViewedAnime (
id SERIAL NOT NULL PRIMARY KEY,
user_id INT NOT NULL,
anime_id INT NOT NULL);


ALTER TABLE ViewedAnime
ADD CONSTRAINT anime_id_fk_constraint
FOREIGN KEY (anime_id) REFERENCES Anime(id)
ON DELETE CASCADE ON UPDATE CASCADE;

ALTER TABLE ViewedAnime
ADD CONSTRAINT user_id_fk_constraint
FOREIGN KEY (user_id) REFERENCES Person(id)
ON DELETE CASCADE ON UPDATE CASCADE;

ALTER TABLE AnimeGenre
ADD CONSTRAINT anime_id_fk_constraint
FOREIGN KEY (anime_id) REFERENCES Anime(id)
ON DELETE CASCADE ON UPDATE CASCADE;

ALTER TABLE AnimeGenre
ADD CONSTRAINT genre_id_fk_constraint
FOREIGN KEY (genre_id) REFERENCES Genre(id)
ON DELETE CASCADE ON UPDATE CASCADE;


ALTER TABLE Anime ADD CONSTRAINT studio_constraint
FOREIGN KEY (studio_id) REFERENCES Studio(id)
ON DELETE CASCADE
ON UPDATE CASCADE;


ALTER TABLE Review
ADD CONSTRAINT anime_id_fk_constraint
FOREIGN KEY (anime_id) REFERENCES Anime(id)
ON DELETE CASCADE ON UPDATE CASCADE;

ALTER TABLE Review
ADD CONSTRAINT user_id_fk_constraint
FOREIGN KEY (user_id) REFERENCES Person(id)
ON DELETE CASCADE ON UPDATE CASCADE;
